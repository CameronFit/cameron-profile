<section class="resume-shell">
  <mat-toolbar class="bar">
    <button mat-button (click)="back()">
      <mat-icon>arrow_back</mat-icon>
      <span class="button-text">Back</span>
    </button>

    <span class="title">{{ currentDocLabel() }}</span>
    <span class="spacer"></span>

    <!-- Switcher -->
    <button mat-stroked-button (click)="show('resume')" [disabled]="isResume()">
      <mat-icon>description</mat-icon>
      <span class="button-text">Résumé</span>
    </button>
    <button mat-stroked-button (click)="show('cover')" [disabled]="!isResume()">
      <mat-icon>drafts</mat-icon>
      <span class="button-text">Cover Letter</span>
    </button>

    <a mat-stroked-button [href]="plainUrl()" target="_blank" rel="noopener">
      <mat-icon>open_in_new</mat-icon>
      <span class="button-text">Open</span>
    </a>
    <a mat-button [href]="plainUrl()" download>
      <mat-icon>download</mat-icon>
      <span class="button-text">Download</span>
    </a>
    <button mat-button (click)="print()">
      <mat-icon>print</mat-icon>
      <span class="button-text">Print</span>
    </button>
  </mat-toolbar>

  <div class="viewer">
    @if (isMobile()) {
      <!-- Mobile: Direct link approach since many mobile browsers don't support embedded PDFs -->
      <div class="mobile-pdf-fallback">
        <mat-icon class="fallback-icon">description</mat-icon>
        <h2>View {{ currentDocLabel() }}</h2>
        <p>Mobile browsers may have limited PDF viewing support.</p>
        <div class="fallback-actions">
          <a mat-raised-button color="primary" [href]="plainUrl()" target="_blank" rel="noopener">
            <mat-icon>open_in_new</mat-icon>
            <span>Open in New Tab</span>
          </a>
          <a mat-stroked-button [href]="plainUrl()" download>
            <mat-icon>download</mat-icon>
            <span>Download PDF</span>
          </a>
        </div>
      </div>
    } @else {
      <!-- Desktop: Use iframe for better compatibility -->
      <iframe 
        [src]="safeUrl()" 
        type="application/pdf" 
        class="pdf-viewer"
        title="{{ currentDocLabel() }}">
        <div class="desktop-fallback">
          <p>
            Your browser can't display PDFs.
            <a [href]="plainUrl()" target="_blank" rel="noopener"
              >Open {{ currentDocLabel() }}</a
            >
            or use the Download button.
          </p>
        </div>
      </iframe>
    }
  </div>
</section>
